sudo: required

language: node_js
cache:
  directories:
    - "node_modules"

jobs:
  include:
    - stage: lint
      script: npm run lint
    - stage: test
      script: npm run test
    - stage: build
      services:
        - docker
      addons:
        apt:
          packages:
            - docker-ce
      env:
        - PLATFORM=armhf
        - PLATFORM=amd64
        - PLATFORM=aarch64
        - PLATFORM=i386
      script: ./build_hassio.sh $PLATFORM
